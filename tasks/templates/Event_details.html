{% extends "base.html" %}
{% block title %}Event Details{% endblock title %}
{% block tasks %}
<section class="py-16 px-4 max-w-5xl mx-auto text-white">
    {% if event %}
        <div class="bg-gray-800 rounded-lg shadow-lg overflow-hidden">
            {% if event.image %}
                <img src="{{ event.image.url }}" alt="{{ event.name }}" class="w-full h-64 object-cover">
            {% else %}
                <img src="https://via.placeholder.com/800x400?text=No+Image" alt="No Image" class="w-full h-64 object-cover">
            {% endif %}
            
            <div class="p-6">
                <h1 class="text-4xl font-bold text-blue-300 mb-4">{{ event.name }}</h1>
                <p class="text-gray-300 mb-4">{{ event.description }}</p>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mt-6">
                    <div>
                        <p><span class="font-semibold">Location:</span> {{ event.location }}</p>
                        <p><span class="font-semibold">Date:</span> {{ event.date }}</p>
                        <p><span class="font-semibold">Time:</span> {{ event.time }}</p>
                    </div>
                    <div>
                        <p><span class="font-semibold">Participants:</span> {{ event.participant.count }}</p>
                        <p><span class="font-semibold">Max Capacity:</span> {{ event.max_capacity }}</p>
                        <p><span class="font-semibold">Category:</span> {{ event.category }}</p>
                    </div>
                </div>

                <div class="mt-8">
                    {% if user.is_authenticated %}
                        {% if not user.is_staff and not user.is_superuser and not user.is_organizer %}
                            {% if user in event.participant.all %}
                                <!-- Cancel RSVP Button -->
                                <form method="post" action="{% url 'cancel_event' event.id %}">
                                    {% csrf_token %}
                                    <button type="submit" class="bg-red-600 px-6 py-2 rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500">
                                        Cancel RSVP
                                    </button>
                                </form>
                            {% else %}
                                <!-- Join Event Button -->
                                <form method="post" action="{% url 'join_event' event.id %}">
                                    {% csrf_token %}
                                    <button type="submit" class="bg-blue-600 px-6 py-2 rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        Join Event
                                    </button>
                                </form>
                            {% endif %}
                        {% endif %}
                    {% else %}
                        <p class="text-gray-400">Please <a href="{% url 'login' %}" class="text-blue-300 underline">login</a> to join this event.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    {% else %}
        <p class="text-center text-gray-400">Event not found.</p>
    {% endif %}
</section>
{% endblock tasks %}
